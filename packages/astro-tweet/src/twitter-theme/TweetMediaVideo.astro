---
import type { MediaAnimatedGif, MediaVideo } from "../api/index.js";
import {
  type EnrichedQuotedTweet,
  type EnrichedTweet,
  getMediaUrl,
  getMp4Video
} from "../utils.js";
import mediaStyles from "./tweet-media.module.css";

interface Props {
  tweet: EnrichedTweet | EnrichedQuotedTweet;
  media: MediaAnimatedGif | MediaVideo;
}

const { media } = Astro.props;
const mp4Video = getMp4Video(media);
---

<video
  class={mediaStyles.image}
  poster={getMediaUrl(media, "small")}
  controls
  muted
  preload="metadata"
>
  <source src={mp4Video.url} type={mp4Video.content_type} />
</video>
